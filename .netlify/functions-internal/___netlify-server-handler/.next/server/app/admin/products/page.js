(()=>{var e={};e.id=4122,e.ids=[4122],e.modules={55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},51205:(e,r,s)=>{"use strict";s.r(r),s.d(r,{GlobalError:()=>l.a,__next_app__:()=>m,originalPathname:()=>p,pages:()=>u,routeModule:()=>x,tree:()=>d});var t=s(73137),i=s(54647),a=s(4183),l=s.n(a),n=s(71775),c={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);s.d(r,c);let o=t.AppPageRouteModule,d=["",{children:["admin",{children:["products",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,44248)),"C:\\Users\\ANIKET\\Documents\\jewllery-main\\jewllery-main\\app\\admin\\products\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,63114)),"C:\\Users\\ANIKET\\Documents\\jewllery-main\\jewllery-main\\app\\admin\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,84075)),"C:\\Users\\ANIKET\\Documents\\jewllery-main\\jewllery-main\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,51918,23)),"next/dist/client/components/not-found-error"]}],u=["C:\\Users\\ANIKET\\Documents\\jewllery-main\\jewllery-main\\app\\admin\\products\\page.tsx"],p="/admin/products/page",m={require:s,loadChunk:()=>Promise.resolve()},x=new o({definition:{kind:i.x.APP_PAGE,page:"/admin/products/page",pathname:"/admin/products",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},892:(e,r,s)=>{Promise.resolve().then(s.bind(s,52545))},52545:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>P});var t=s(60080),i=s(9885),a=s(52995),l=s(22385),n=s(69518),c=s(37004),o=s(22388),d=s(34010),u=s(26303),p=s(68384),m=s(97052),x=s(49424),h=s(33478),g=s(70589),j=s(66698),y=s(24796),v=s(51839),f=s(54747),N=s(25072),w=s(77988),_=s(57114);let b=({formData:e,setFormData:r,handleSubmit:s,imagePreview:i,fileInputRef:l,setIsProductDialogOpen:n,selectedProduct:c})=>(0,t.jsxs)("form",{onSubmit:s,className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[t.jsx(h._,{htmlFor:"name",children:"Product Name *"}),t.jsx("input",{id:"name",className:"w-full border rounded px-3 py-2",value:e.name,onChange:e=>r(r=>({...r,name:e.target.value})),required:!0})]}),(0,t.jsxs)("div",{children:[t.jsx(h._,{htmlFor:"price",children:"Price (₹) *"}),t.jsx("input",{id:"price",type:"number",className:"w-full border rounded px-3 py-2",value:e.price,onChange:e=>r(r=>({...r,price:e.target.value})),required:!0})]}),(0,t.jsxs)("div",{children:[t.jsx(h._,{htmlFor:"category",children:"Category"}),t.jsx("input",{id:"category",className:"w-full border rounded px-3 py-2",value:e.category,onChange:e=>r(r=>({...r,category:e.target.value}))})]})]}),(0,t.jsxs)("div",{children:[t.jsx(h._,{htmlFor:"description",children:"Full Description"}),t.jsx("textarea",{id:"description",className:"w-full border rounded px-3 py-2",value:e.description,onChange:e=>r(r=>({...r,description:e.target.value}))})]}),(0,t.jsxs)("div",{children:[t.jsx(h._,{htmlFor:"short_description",children:"Short Description"}),t.jsx("input",{id:"short_description",className:"w-full border rounded px-3 py-2",value:e.short_description,onChange:e=>r(r=>({...r,short_description:e.target.value})),placeholder:"Brief product description"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[t.jsx(h._,{htmlFor:"discount",children:"Discount (%)"}),t.jsx("input",{id:"discount",type:"number",className:"w-full border rounded px-3 py-2",value:e.discount,onChange:e=>r(r=>({...r,discount:e.target.value})),placeholder:"Optional discount"})]}),(0,t.jsxs)("div",{children:[t.jsx(h._,{htmlFor:"image",children:"Product Image *"}),t.jsx("input",{id:"image",type:"file",accept:"image/*",ref:l,onChange:e=>r(r=>({...r,imageFile:e.target.files&&e.target.files[0]}))}),i&&t.jsx("div",{className:"mt-2",children:t.jsx("img",{src:i,alt:"Preview",className:"w-32 h-32 object-cover rounded border"})})]})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[t.jsx(p.z,{type:"button",variant:"outline",onClick:()=>n(!1),children:"Cancel"}),(0,t.jsxs)(p.z,{type:"submit",className:"bg-gradient-to-r from-amber-600 to-orange-600",children:[t.jsx(a.Z,{className:"w-4 h-4 mr-2"}),c?"Update":"Create"," Product"]})]})]});function P(){let[e,r]=(0,i.useState)([]),[s,a]=(0,i.useState)(!0),[h,P]=(0,i.useState)(""),[q,C]=(0,i.useState)("all"),[S,k]=(0,i.useState)("all"),[E,A]=(0,i.useState)(!1),[F,I]=(0,i.useState)(null),[D,O]=(0,i.useState)({name:"",description:"",price:"",category:"",short_description:"",discount:"",imageFile:null,imageUrl:""}),[U,z]=(0,i.useState)("");(0,_.useRouter)();let T=(0,i.useRef)(null),Z=async()=>{let e=w.O.from("products").select("*");"all"!==q&&(e=e.eq("category",q)),h&&(e=e.or(`name.ilike.%${h}%,description.ilike.%${h}%`)),"active"===S?e=e.eq("in_stock",!0):"inactive"===S&&(e=e.eq("in_stock",!1));let{data:r,error:s}=await e.order("created_at",{ascending:!1});if(s)throw s;return r||[]},Q=(0,N.c)(Z,"products",[h,q,S]);(0,i.useEffect)(()=>{Q&&(r(Q),a(!1))},[Q]);let $=async()=>{a(!0);try{let e=await Z();r(e)}catch(e){}finally{a(!1)}},K=async e=>{if(e.preventDefault(),!D.name||!D.price){alert("Please fill all required fields.");return}if(!F&&!D.imageFile){alert("Please select a product image.");return}try{let e,r=D.imageUrl;if(D.imageFile){let e=D.imageFile.name.split(".").pop(),s=`${Date.now()}.${e}`,{data:t,error:i}=await w.O.storage.from("product-images").upload(s,D.imageFile,{upsert:!0});if(i){console.error("Image upload error:",i),alert("Image upload error: "+JSON.stringify(i));return}let{data:a}=w.O.storage.from("product-images").getPublicUrl(s);r=(r=a.publicUrl).replace(/([^:]\/)\/+/,"$1")}let s={name:D.name,description:D.description,price:parseInt(D.price),category:D.category,short_description:D.short_description,discount:D.discount?parseInt(D.discount):null,image_url:r};if(F){alert("Product update not implemented via API yet.");return}e=await fetch("/api/admin/products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});let t=await e.json();if(!t.success){alert("API error: "+t.error);return}A(!1),I(null),M(),await $(),alert("Product saved successfully!")}catch(e){console.error("Error saving product:",e),alert("Error saving product: "+(e?.message||JSON.stringify(e)))}},M=()=>{O({name:"",description:"",price:"",category:"",short_description:"",discount:"",imageFile:null,imageUrl:""}),z("")},R=e=>{I(e),O({name:e.name||"",description:e.description||"",category:e.category||"",short_description:e.short_description||"",discount:e.discount?.toString()||"",price:e.price?.toString()||"",imageFile:null,imageUrl:e.image_url||""}),z(e.image_url||""),A(!0)},B=async(e,r)=>{if(confirm("Are you sure you want to delete this product?"))try{let s=await fetch("/api/admin/products",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,image_url:r})}),t=await s.json();if(!t.success)throw Error(t.error);await $(),alert("Product deleted successfully!")}catch(e){console.error("Error deleting product:",e),alert("Error deleting product. Please try again.")}},G=async e=>{try{let{error:r}=await w.O.from("products").update({is_active:!e.is_active}).eq("id",e.id);if(r)throw r;alert("Product status updated successfully!")}catch(e){console.error("Error updating product status:",e),alert("Error updating product status. Please try again.")}};return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[t.jsx("header",{className:"bg-white shadow-sm border-b",children:t.jsx("div",{className:"px-6 py-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Product Management"}),t.jsx("p",{className:"text-gray-600",children:"Manage your jewelry catalog"})]}),(0,t.jsxs)(v.Vq,{open:E,onOpenChange:A,children:[t.jsx(v.hg,{asChild:!0,children:(0,t.jsxs)(p.z,{className:"bg-gradient-to-r from-amber-600 to-orange-600",onClick:()=>{I(null),M()},children:[t.jsx(l.Z,{className:"w-4 h-4 mr-2"}),"Add Product"]})}),(0,t.jsxs)(v.cZ,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[t.jsx(v.fK,{children:t.jsx(v.$N,{children:F?"Edit Product":"Add New Product"})}),t.jsx(b,{formData:D,setFormData:O,handleSubmit:K,imagePreview:U,fileInputRef:T,setIsProductDialogOpen:A,selectedProduct:F})]})]})]})})}),(0,t.jsxs)("div",{className:"p-6",children:[t.jsx(m.Zb,{className:"mb-6",children:t.jsx(m.aY,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,t.jsxs)("div",{className:"relative flex-1",children:[t.jsx(n.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),t.jsx(x.I,{placeholder:"Search products...",className:"pl-10",value:h,onChange:e=>P(e.target.value)})]}),(0,t.jsxs)(g.Ph,{value:q,onValueChange:C,children:[t.jsx(g.i4,{className:"w-48",children:t.jsx(g.ki,{placeholder:"Filter by category"})}),(0,t.jsxs)(g.Bw,{children:[t.jsx(g.Ql,{value:"all",children:"All Categories"}),t.jsx(g.Ql,{value:"Necklaces",children:"Necklaces"}),t.jsx(g.Ql,{value:"Earrings",children:"Earrings"}),t.jsx(g.Ql,{value:"Bangles",children:"Bangles"}),t.jsx(g.Ql,{value:"Rings",children:"Rings"})]})]}),(0,t.jsxs)(g.Ph,{value:S,onValueChange:k,children:[t.jsx(g.i4,{className:"w-48",children:t.jsx(g.ki,{placeholder:"Filter by status"})}),(0,t.jsxs)(g.Bw,{children:[t.jsx(g.Ql,{value:"all",children:"All Status"}),t.jsx(g.Ql,{value:"active",children:"Active"}),t.jsx(g.Ql,{value:"inactive",children:"Inactive"})]})]})]})})}),t.jsx(m.Zb,{children:(0,t.jsxs)(m.aY,{className:"pt-6",children:[s?t.jsx("div",{className:"text-center py-8",children:t.jsx("p",{className:"text-gray-500",children:"Loading products..."})}):(0,t.jsxs)(f.iA,{children:[t.jsx(f.xD,{children:(0,t.jsxs)(f.SC,{children:[t.jsx(f.ss,{children:"Product"}),t.jsx(f.ss,{children:"Category"}),t.jsx(f.ss,{children:"Price"}),t.jsx(f.ss,{children:"Stock"}),t.jsx(f.ss,{children:"Status"}),t.jsx(f.ss,{children:"Actions"})]})}),t.jsx(f.RM,{children:e.map(e=>(0,t.jsxs)(f.SC,{children:[t.jsx(f.pj,{children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-lg flex items-center justify-center",children:t.jsx(c.Z,{className:"w-6 h-6 text-gray-400"})}),(0,t.jsxs)("div",{children:[t.jsx("div",{className:"font-semibold",children:e.name}),(0,t.jsxs)("div",{className:"text-sm text-gray-500",children:["SKU: ",e.sku||"N/A"]})]})]})}),t.jsx(f.pj,{children:e.category}),(0,t.jsxs)(f.pj,{className:"font-semibold",children:["₹",parseFloat(String(e.price)).toLocaleString()]}),t.jsx(f.pj,{children:t.jsx(y.C,{variant:e.stock_quantity>10?"default":e.stock_quantity>0?"secondary":"destructive",children:e.stock_quantity>0?e.stock_quantity:"Out of Stock"})}),t.jsx(f.pj,{children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx(j.r,{checked:e.is_active,onCheckedChange:()=>G(e)}),t.jsx(y.C,{className:e.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800",children:e.is_active?"Active":"Inactive"})]})}),t.jsx(f.pj,{children:(0,t.jsxs)("div",{className:"flex gap-2",children:[t.jsx(p.z,{size:"sm",variant:"outline",children:t.jsx(o.Z,{className:"w-4 h-4"})}),t.jsx(p.z,{size:"sm",variant:"outline",onClick:()=>R(e),children:t.jsx(d.Z,{className:"w-4 h-4"})}),t.jsx(p.z,{size:"sm",variant:"outline",onClick:()=>B(String(e.id),e.image_url),children:t.jsx(u.Z,{className:"w-4 h-4"})})]})})]},e.id))})]}),!s&&0===e.length&&t.jsx("div",{className:"text-center py-8",children:t.jsx("p",{className:"text-gray-500",children:"No products found."})})]})})]})]})}},44248:(e,r,s)=>{"use strict";s.r(r),s.d(r,{$$typeof:()=>l,__esModule:()=>a,default:()=>c});var t=s(17536);let i=(0,t.createProxy)(String.raw`C:\Users\ANIKET\Documents\jewllery-main\jewllery-main\app\admin\products\page.tsx`),{__esModule:a,$$typeof:l}=i,n=i.default,c=n}};var r=require("../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[3447,1971,2451,6206,5138,4745,2730,7589,7888,5247,8203,823,2903,3195,3198,6261,8384,4796,7052,2065,1839,9378,2970,6777,589,5072,4747,6698],()=>s(51205));module.exports=t})();